var D=Object.defineProperty,oe=Object.defineProperties,se=Object.getOwnPropertyDescriptor,ie=Object.getOwnPropertyDescriptors,ae=Object.getOwnPropertyNames,H=Object.getOwnPropertySymbols;var G=Object.prototype.hasOwnProperty,ce=Object.prototype.propertyIsEnumerable;var L=(d,e,n)=>e in d?D(d,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):d[e]=n,A=(d,e)=>{for(var n in e||(e={}))G.call(e,n)&&L(d,n,e[n]);if(H)for(var n of H(e))ce.call(e,n)&&L(d,n,e[n]);return d},E=(d,e)=>oe(d,ie(e));var N=(d,e)=>()=>(d&&(e=d(d=0)),e);var le=(d,e)=>{for(var n in e)D(d,n,{get:e[n],enumerable:!0})},fe=(d,e,n,t)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of ae(e))!G.call(d,r)&&r!==n&&D(d,r,{get:()=>e[r],enumerable:!(t=se(e,r))||t.enumerable});return d};var pe=d=>fe(D({},"__esModule",{value:!0}),d);var x=(d,e,n)=>L(d,typeof e!="symbol"?e+"":e,n);var O,K=N(()=>{"use strict";O=class{constructor(){x(this,"tokens",[]);x(this,"errors",[]);x(this,"tokenMap",new Map)}parse(e,n=""){return this.tokens=[],this.errors=[],this.tokenMap=new Map,this.collectTokens(e,[]),this.resolveAliases(),this.validateTokens(),{tokens:this.tokens,metadata:{filePath:n,format:"auto-detected",errors:this.errors}}}collectTokens(e,n){if(e==null)return;let t=n[n.length-1]||"";if(!(t.startsWith("$")&&t!=="$value"&&t!=="$type")){if(this.isW3CToken(e)){this.addToken(e.$value,e.$type,e.$description,e.$extensions,n);return}if(this.isTokenStudioToken(e)){this.addToken(e.value,e.type,e.description,e.extensions,n);return}if(this.isPrimitiveToken(e,n)){this.addToken(e,void 0,void 0,void 0,n);return}if(typeof e=="object"){let r=Array.isArray(e)?e.map((s,o)=>String(o)):Object.keys(e);for(let s of r){if(s.startsWith("$")||s==="extensions"||s==="description")continue;let o=Array.isArray(e)?e[parseInt(s)]:e[s];this.collectTokens(o,[...n,s])}}}}addToken(e,n,t,r,s){let o=s[s.length-1]||"unnamed",a=this.inferTokenType({$value:e,$type:n},s),f;typeof e=="string"&&(e.startsWith("{")||e.startsWith("$"))&&(f=this.extractAliases(e));let u={name:o,value:e,type:a,path:[...s],description:t,extensions:r,rawValue:e,aliases:f};this.tokens.push(u),this.tokenMap.set(s.join("."),u)}isW3CToken(e){return e&&typeof e=="object"&&"$value"in e}isTokenStudioToken(e){if(!e||typeof e!="object"||"$value"in e||!("value"in e))return!1;let n=e.value;return typeof n=="string"||typeof n=="number"||typeof n=="boolean"?!0:typeof n=="object"&&n!==null?"type"in e||"description"in e:!1}isPrimitiveToken(e,n){return!(typeof e!="string"&&typeof e!="number"&&typeof e!="boolean"||n.length<1)}isDesignToken(e){return this.isW3CToken(e)}inferTokenType(e,n){if(e.$type)return e.$type;let t=n.join(".").toLowerCase();if(t.includes("color")||t.includes("colour"))return"color";if(t.includes("font")||t.includes("typography")||t.includes("text"))return t.includes("weight")?"fontWeight":t.includes("family")?"fontFamily":"typography";if(t.includes("spacing")||t.includes("size")||t.includes("gap"))return"dimension";if(t.includes("shadow"))return"shadow";if(t.includes("border"))return"border";let r=e.$value;if(typeof r=="string"){if(r.match(/^#[0-9A-Fa-f]{3,8}$/)||r.match(/^rgba?\(/)||r.match(/^hsla?\(/))return"color";if(r.match(/^-?\d+(\.\d+)?(px|rem|em|pt|pc|in|cm|mm|q|vh|vw|vmin|vmax|%)$/))return"dimension";if(r.match(/^\d+(\.\d+)?(ms|s)$/))return"duration"}return typeof r=="number"?"number":typeof r=="boolean"?"boolean":"string"}extractAliases(e){let n=[],t=/\{([^}]+)\}/g,r;for(;(r=t.exec(e))!==null;){let s=r[1].split(",").map(o=>o.trim())[0];s.startsWith("$")&&(s=s.substring(1)),n.push(s)}if(e.startsWith("$")&&!e.startsWith("{")){let s=/\$([a-zA-Z0-9._-]+)/g;for(;(r=s.exec(e))!==null;)n.push(r[1])}return n}resolveAliases(){for(let e of this.tokens)if(e.aliases&&e.aliases.length>0)for(let n of e.aliases){let t=this.tokenMap.get(n);t?(e.value=t.value,e.aliases||(e.aliases=[])):this.errors.push({path:e.path,message:`Unresolved alias: ${n}`,severity:"error"})}}validateTokens(){for(let e of this.tokens){let n=this.validateTokenValue(e);n.valid||this.errors.push({path:e.path,message:n.message||"Validation error",severity:n.severity||"error"})}}validateTokenValue(e){let{type:n,value:t}=e;if(t==null)return{valid:!1,message:"Token value cannot be null or undefined",severity:"error"};switch(n){case"color":return this.validateColor(t);case"dimension":return this.validateDimension(t);case"fontWeight":return this.validateFontWeight(t);case"duration":return this.validateDuration(t);case"typography":return this.validateTypography(t);case"shadow":return this.validateShadow(t);default:return{valid:!0}}}validateColor(e){return typeof e!="string"?{valid:!1,message:"Color value must be a string",severity:"error"}:[/^#[0-9A-Fa-f]{3,8}$/,/^rgba?\([^)]+\)$/,/^hsla?\([^)]+\)$/].some(r=>r.test(e))?{valid:!0}:{valid:!1,message:`Invalid color format: ${e}`,severity:"error"}}validateDimension(e){if(typeof e=="string"){if(!/^-?\d+(\.\d+)?(px|rem|em|pt|pc|in|cm|mm|q|vh|vw|vmin|vmax|%)$/.test(e))return{valid:!1,message:`Invalid dimension format: ${e}`,severity:"error"}}else return typeof e=="number"?{valid:!0}:{valid:!1,message:"Dimension value must be a string or number",severity:"error"};return{valid:!0}}validateFontWeight(e){if(typeof e=="string"){if(!["100","200","300","400","500","600","700","800","900","normal","bold"].includes(e))return{valid:!1,message:`Invalid font weight: ${e}`,severity:"warning"}}else if(typeof e=="number"){if(e<1||e>1e3)return{valid:!1,message:"Font weight must be between 1 and 1000",severity:"error"}}else return{valid:!1,message:"Font weight must be a string or number",severity:"error"};return{valid:!0}}validateDuration(e){return typeof e!="string"?{valid:!1,message:"Duration value must be a string",severity:"error"}:/^\d+(\.\d+)?(ms|s)$/.test(e)?{valid:!0}:{valid:!1,message:`Invalid duration format: ${e}`,severity:"error"}}validateTypography(e){return typeof e!="object"||Array.isArray(e)?{valid:!1,message:"Typography value must be an object",severity:"error"}:e.fontFamily?{valid:!0}:{valid:!1,message:"Typography token missing fontFamily",severity:"warning"}}validateShadow(e){return typeof e!="object"||Array.isArray(e)?{valid:!1,message:"Shadow value must be an object",severity:"error"}:e.color?{valid:!0}:{valid:!1,message:"Shadow token missing color",severity:"warning"}}getTokensByType(e){return this.tokens.filter(n=>n.type===e)}getTokenByPath(e){return this.tokenMap.get(e.join("."))}getErrors(){return this.errors}}});var I,j=N(()=>{"use strict";K();I=class{constructor(){x(this,"parser");this.parser=new O}parseGitHubUrl(e){let n=[/github\.com[\/:]([^\/]+)\/([^\/\.]+)(\.git)?$/,/github\.com\/([^\/]+)\/([^\/]+)/];for(let t of n){let r=e.match(t);if(r)return{owner:r[1],repo:r[2]}}return null}async fetchBranches(e,n,t){try{let r=await fetch(`https://api.github.com/repos/${e}/${n}/branches`,{headers:{Authorization:`Bearer ${t}`,Accept:"application/vnd.github.v3+json"}});if(!r.ok)throw new Error(`GitHub API error: ${r.status}`);return(await r.json()).map(o=>o.name)}catch(r){throw new Error(`Failed to fetch branches: ${r}`)}}async fetchFileContents(e,n,t,r,s){try{let o=`https://api.github.com/repos/${e}/${n}/contents/${s}?ref=${t}`,a=await fetch(o,{headers:{Authorization:`Bearer ${r}`,Accept:"application/vnd.github.v3+json"}});if(!a.ok)throw new Error(`GitHub API error: ${a.status}`);return await a.json()}catch(o){throw new Error(`Failed to fetch file contents: ${o}`)}}async fetchDirectoryContents(e,n,t,r,s=""){try{let o=`https://api.github.com/repos/${e}/${n}/contents/${s}?ref=${t}`,a=await fetch(o,{headers:{Authorization:`Bearer ${r}`,Accept:"application/vnd.github.v3+json"}});if(!a.ok)throw new Error(`GitHub API error: ${a.status}`);let f=await a.json();return Array.isArray(f)?f:[f]}catch(o){throw new Error(`Failed to fetch directory contents: ${o}`)}}decodeBase64Content(e){try{let n=e.replace(/\s/g,""),t;if(typeof atob=="function")t=atob(n);else{let s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";t="";let o=0,a=n.replace(/=+$/,"");for(;o<a.length;){let f=s.indexOf(a.charAt(o++)),u=s.indexOf(a.charAt(o++)),y=s.indexOf(a.charAt(o++)),l=s.indexOf(a.charAt(o++)),g=f<<18|u<<12|(y&63)<<6|l&63;t+=String.fromCharCode(g>>16&255),y!==-1&&(t+=String.fromCharCode(g>>8&255)),l!==-1&&(t+=String.fromCharCode(g&255))}}let r;if(typeof TextDecoder!="undefined"){let s=new Uint8Array(t.length);for(let o=0;o<t.length;o++)s[o]=t.charCodeAt(o);r=new TextDecoder("utf-8").decode(s)}else try{r=decodeURIComponent(escape(t))}catch(s){r=t}return r.charCodeAt(0)===65279&&(r=r.slice(1)),r=r.replace(/\0/g,""),r=r.trim(),r}catch(n){throw new Error(`Failed to decode base64 content: ${n}`)}}parseJSONContent(e){try{return JSON.parse(e)}catch(n){throw new Error(`Failed to parse JSON: ${n}`)}}flattenTokens(e,n=[]){let t=[],r=[],s=l=>l&&typeof l=="object"&&"$value"in l,o=l=>{if(!l||typeof l!="object"||"$value"in l||!("value"in l))return!1;let g=l.value;return typeof g=="string"||typeof g=="number"||typeof g=="boolean"?!0:typeof g=="object"&&g!==null?"type"in l||"description"in l:!1},a=(l,g)=>!(typeof l!="string"&&typeof l!="number"&&typeof l!="boolean"||g.length<1),f=(l,g)=>{let T=g.join(".").toLowerCase();if(typeof l=="string"){if(l.match(/^#[0-9A-Fa-f]{3,8}$/)||l.match(/^rgba?\(/)||l.match(/^hsla?\(/)||T.includes("color"))return"color";if(l.match(/^\d+(\.\d+)?(ms|s)$/)||T.includes("duration"))return"duration";if(l.match(/^-?\d+(\.\d+)?(px|rem|em|pt|pc|in|cm|mm|q|vh|vw|vmin|vmax|%)$/)||T.includes("size")||T.includes("spacing")||T.includes("radius"))return"dimension";if(T.includes("font")||T.includes("typography"))return"typography";if(T.includes("shadow"))return"shadow"}else if(typeof l=="number")return"number";return"string"},u=(l,g,T)=>{let i=T[T.length-1]||"unnamed",c=g||f(l,T);t.push({name:i,path:T,type:c,value:l,rawValue:l})},y=(l,g)=>{if(l==null)return;let T=g[g.length-1]||"";if(!(T.startsWith("$")&&T!=="$value"&&T!=="$type")){if(s(l)){u(l.$value,l.$type,g);return}if(o(l)){u(l.value,l.type,g);return}if(a(l,g)){u(l,void 0,g);return}if(l&&typeof l=="object"){let i=Array.isArray(l)?l.map((c,p)=>String(p)):Object.keys(l);for(let c of i){if(!Array.isArray(l)&&(c.startsWith("$")||c==="extensions"))continue;let p=Array.isArray(l)?l[parseInt(c)]:l[c];y(p,[...g,c])}}}};try{y(e,[])}catch(l){r.push({path:[],message:l instanceof Error?l.message:"Failed to walk tokens"})}return{tokens:t,metadata:{filePath:"",format:"auto-detected",errors:r}}}async fetchTokens(e,n,t,r,s){let o=await this.fetchFileContents(e,n,t,r,s);if(o.type!=="file")throw new Error(`Path is not a file: ${s}`);if(!o.content)throw new Error("File content is empty");let a=this.decodeBase64Content(o.content),f=this.parseJSONContent(a),u=this.parser.parse(f,s);return(!u.tokens||u.tokens.length===0)&&(u=this.flattenTokens(f,[])),u}async detectTokenFiles(e,n,t,r,s=""){let o=await this.fetchDirectoryContents(e,n,t,r,s),a=[/package\.json$/i,/package-lock\.json$/i,/tsconfig\.json$/i,/\.config\.json$/i,/eslint.*\.json$/i,/prettier.*\.json$/i,/jest\.config\.json$/i,/webpack\.config\.json$/i,/^\$metadata\.json$/i,/^\$themes\.json$/i,/\(ignore\)\.json$/i],f=[];for(let u of o)if(u.type==="file"){let y=u.name.toLowerCase();y.endsWith(".json")&&(a.some(g=>g.test(y))||f.push(u.path))}else if(u.type==="dir"){let y=await this.detectTokenFiles(e,n,t,r,u.path);f.push(...y)}return f}}});var V,J=N(()=>{"use strict";V=class{constructor(){x(this,"errors",[]);x(this,"TOKENS_STUDIO_NAMESPACE","tokens")}getTokenReference(e,n){try{let t=["tokens","tokens-studio","tokensStudio","design-tokens"];for(let r of t)try{let s=e.getSharedPluginData(r,n);if(s&&s.trim())return s}catch(s){}try{let r=e.getPluginData(n);if(r&&r.trim())return r}catch(r){}}catch(t){}}getFillTokenReferences(e,n){let t=[`fills[${n}]`,`fill[${n}]`,`fills.${n}`,`fill.${n}`,"fill","fills","fillColor",`fillColor[${n}]`];for(let r of t){let s=this.getTokenReference(e,r);if(s)return s}}getStrokeTokenReferences(e,n){let t=[`strokes[${n}]`,`stroke[${n}]`,`strokes.${n}`,`stroke.${n}`,"stroke","strokes","strokeColor",`strokeColor[${n}]`,"borderColor"];for(let r of t){let s=this.getTokenReference(e,r);if(s)return s}}getTypographyTokenReference(e,n){let r={fontFamily:["fontFamily","fontFamilies","font-family","typography.fontFamily"],fontSize:["fontSize","fontSizes","font-size","typography.fontSize"],fontWeight:["fontWeight","fontWeights","font-weight","typography.fontWeight"],lineHeight:["lineHeight","lineHeights","line-height","typography.lineHeight"],letterSpacing:["letterSpacing","letter-spacing","typography.letterSpacing"],typography:["typography","text","textStyle","text-style"]}[n]||[n];for(let s of r){let o=this.getTokenReference(e,s);if(o)return o}}getSpacingTokenReference(e,n){let r={width:["width","sizing","sizing.width"],height:["height","sizing","sizing.height"],padding:["padding","paddingTop","paddingRight","paddingBottom","paddingLeft","spacing.padding"],paddingTop:["paddingTop","padding-top","spacing.paddingTop"],paddingRight:["paddingRight","padding-right","spacing.paddingRight"],paddingBottom:["paddingBottom","padding-bottom","spacing.paddingBottom"],paddingLeft:["paddingLeft","padding-left","spacing.paddingLeft"],gap:["itemSpacing","gap","spacing","spacing.gap"],borderRadius:["borderRadius","border-radius","radius","cornerRadius"],borderWidth:["borderWidth","border-width","strokeWidth"]}[n]||[n];for(let s of r){let o=this.getTokenReference(e,s);if(o)return o}}getEffectTokenReference(e,n){let t=[`effects[${n}]`,`effect[${n}]`,`boxShadow[${n}]`,"boxShadow","shadow","effects","effect","dropShadow","innerShadow"];for(let r of t){let s=this.getTokenReference(e,r);if(s)return s}}scanAllComponents(){this.errors=[];let e=[],n=0,t=figma.root.children;for(let r of t)if(r.type==="PAGE"){let s=r.findAll(a=>a.type==="COMPONENT"||a.type==="COMPONENT_SET"),o=r.findAll(a=>a.type==="INSTANCE");n+=o.length;for(let a of s)try{let f=this.extractComponentProperties(a,r.name);f&&e.push(f)}catch(f){this.errors.push({componentId:a.id,componentName:a.name,error:f instanceof Error?f.message:"Unknown error"})}}return{components:e,totalComponents:e.length,totalInstances:n,pagesScanned:t.length,errors:this.errors}}scanCurrentPage(){this.errors=[];let e=[],n=figma.currentPage,t=0,r=n.findAll(o=>o.type==="COMPONENT"||o.type==="COMPONENT_SET"),s=n.findAll(o=>o.type==="INSTANCE");t+=s.length;for(let o of r)try{let a=this.extractComponentProperties(o,n.name);a&&e.push(a)}catch(a){this.errors.push({componentId:o.id,componentName:o.name,error:a instanceof Error?a.message:"Unknown error"})}return{components:e,totalComponents:e.length,totalInstances:t,pagesScanned:1,errors:this.errors}}scanNodes(e){this.errors=[];let n=[],t=0,r=figma.currentPage;for(let s of e){let o=[],a=[];"findAll"in s&&typeof s.findAll=="function"&&(o=s.findAll(f=>f.type==="COMPONENT"||f.type==="COMPONENT_SET"),a=s.findAll(f=>f.type==="INSTANCE"),t+=a.length);for(let f of o)try{let u=this.extractComponentProperties(f,r.name);u&&n.push(u)}catch(u){this.errors.push({componentId:f.id,componentName:f.name,error:u instanceof Error?u.message:"Unknown error"})}if(s.type==="COMPONENT"||s.type==="COMPONENT_SET")try{let f=this.extractComponentProperties(s,r.name);f&&(n.find(u=>u.id===f.id)||n.push(f))}catch(f){this.errors.push({componentId:s.id,componentName:s.name,error:f instanceof Error?f.message:"Unknown error"})}}return{components:n,totalComponents:n.length,totalInstances:t,pagesScanned:1,errors:this.errors}}extractComponentProperties(e,n){if(e.type!=="COMPONENT"&&e.type!=="COMPONENT_SET"&&e.type!=="INSTANCE")return null;let t={id:e.id,name:e.name,type:e.type,pageName:n,colors:[],typography:[],spacing:[],effects:[]};if(t.colors=this.extractColors(e),t.typography=this.extractTypography(e),t.spacing=this.extractSpacing(e),t.effects=this.extractEffects(e),e.type==="COMPONENT"||e.type==="COMPONENT_SET"){let r=e;"layoutMode"in r&&r.layoutMode&&(t.layoutMode=r.layoutMode,t.itemSpacing=r.itemSpacing,t.paddingTop=r.paddingTop,t.paddingRight=r.paddingRight,t.paddingBottom=r.paddingBottom,t.paddingLeft=r.paddingLeft),t.width=r.width,t.height=r.height}else if(e.type==="INSTANCE"){let r=e;t.width=r.width,t.height=r.height}if("children"in e){let r=[];for(let s of e.children){let o=this.extractComponentProperties(s,n);o&&r.push(o)}r.length>0&&(t.children=r)}return t}extractColors(e){var t,r;let n=[];if("fills"in e&&Array.isArray(e.fills))for(let s=0;s<e.fills.length;s++){let o=e.fills[s];if(o.type==="SOLID"){let a=(t=o.opacity)!=null?t:1,f=this.rgbaToColor(o.color,a),u=this.getFillTokenReferences(e,s);n.push({type:"fill",color:{r:o.color.r,g:o.color.g,b:o.color.b,a},hex:f.hex,rgba:f.rgba,opacity:a,tokenReference:u})}}if("strokes"in e&&Array.isArray(e.strokes))for(let s=0;s<e.strokes.length;s++){let o=e.strokes[s];if(o.type==="SOLID"){let a=(r=o.opacity)!=null?r:1,f=this.rgbaToColor(o.color,a),u=this.getStrokeTokenReferences(e,s);n.push({type:"stroke",color:{r:o.color.r,g:o.color.g,b:o.color.b,a},hex:f.hex,rgba:f.rgba,opacity:a,tokenReference:u})}}return n}extractTypography(e){let n=[];if(e.type==="TEXT"){let t=e;if(typeof t.fontName!="symbol"){let r=t.fontName,s=this.getTypographyTokenReference(t,"typography"),o=this.getTypographyTokenReference(t,"fontFamily"),a=this.getTypographyTokenReference(t,"fontSize"),f=this.getTypographyTokenReference(t,"fontWeight"),u=this.getTypographyTokenReference(t,"lineHeight"),y=this.getTypographyTokenReference(t,"letterSpacing"),l=s||o||a||f||u||y;n.push({fontFamily:r.family,fontSize:typeof t.fontSize=="number"?t.fontSize:16,fontWeight:typeof r.style=="string"?this.parseFontWeight(r.style):400,lineHeight:typeof t.lineHeight=="number"||typeof t.lineHeight=="string"?t.lineHeight:void 0,letterSpacing:typeof t.letterSpacing=="number"?t.letterSpacing:void 0,textDecoration:typeof t.textDecoration=="string"?t.textDecoration:void 0,textCase:typeof t.textCase=="string"?t.textCase:void 0,tokenReference:l})}}if("children"in e)for(let t of e.children)n.push(...this.extractTypography(t));return n}extractSpacing(e){let n=[];if(e.type==="COMPONENT"||e.type==="COMPONENT_SET"){let t=e,r=this.getSpacingTokenReference(e,"width"),s=this.getSpacingTokenReference(e,"height");if(n.push({type:"width",value:t.width,unit:"px",tokenReference:r}),n.push({type:"height",value:t.height,unit:"px",tokenReference:s}),"paddingTop"in t&&typeof t.paddingTop=="number"){let o=this.getSpacingTokenReference(e,"paddingTop"),a=this.getSpacingTokenReference(e,"paddingRight"),f=this.getSpacingTokenReference(e,"paddingBottom"),u=this.getSpacingTokenReference(e,"paddingLeft"),y=this.getSpacingTokenReference(e,"padding");t.paddingTop&&n.push({type:"padding",value:t.paddingTop,unit:"px",tokenReference:o||y}),t.paddingRight&&n.push({type:"padding",value:t.paddingRight,unit:"px",tokenReference:a||y}),t.paddingBottom&&n.push({type:"padding",value:t.paddingBottom,unit:"px",tokenReference:f||y}),t.paddingLeft&&n.push({type:"padding",value:t.paddingLeft,unit:"px",tokenReference:u||y})}if("itemSpacing"in t&&typeof t.itemSpacing=="number"&&t.itemSpacing){let o=this.getSpacingTokenReference(e,"gap");n.push({type:"gap",value:t.itemSpacing,unit:"px",tokenReference:o})}if("cornerRadius"in t&&typeof t.cornerRadius=="number"&&t.cornerRadius>0){let o=this.getSpacingTokenReference(e,"borderRadius");n.push({type:"padding",value:t.cornerRadius,unit:"px",tokenReference:o})}}else if(e.type==="INSTANCE"){let t=e,r=this.getSpacingTokenReference(e,"width"),s=this.getSpacingTokenReference(e,"height");n.push({type:"width",value:t.width,unit:"px",tokenReference:r}),n.push({type:"height",value:t.height,unit:"px",tokenReference:s})}return n}extractEffects(e){var t,r,s,o,a,f,u,y;let n=[];if("effects"in e&&Array.isArray(e.effects))for(let l=0;l<e.effects.length;l++){let g=e.effects[l];if(g.visible){let T=this.getEffectTokenReference(e,l);switch(g.type){case"DROP_SHADOW":n.push({type:"drop-shadow",visible:g.visible,radius:g.radius,color:g.color?{r:g.color.r,g:g.color.g,b:g.color.b,a:g.color.a}:void 0,offset:{x:(r=(t=g.offset)==null?void 0:t.x)!=null?r:0,y:(o=(s=g.offset)==null?void 0:s.y)!=null?o:0},spread:g.spread,tokenReference:T});break;case"INNER_SHADOW":n.push({type:"inner-shadow",visible:g.visible,radius:g.radius,color:g.color?{r:g.color.r,g:g.color.g,b:g.color.b,a:g.color.a}:void 0,offset:{x:(f=(a=g.offset)==null?void 0:a.x)!=null?f:0,y:(y=(u=g.offset)==null?void 0:u.y)!=null?y:0},spread:g.spread,tokenReference:T});break;case"LAYER_BLUR":n.push({type:"layer-blur",visible:g.visible,radius:g.radius,tokenReference:T});break;case"BACKGROUND_BLUR":n.push({type:"background-blur",visible:g.visible,radius:g.radius,tokenReference:T});break}}}return n}rgbaToColor(e,n){let t=Math.round(e.r*255),r=Math.round(e.g*255),s=Math.round(e.b*255),o=n,a=`#${[t,r,s].map(u=>{let y=u.toString(16);return y.length===1?"0"+y:y}).join("")}`,f=`rgba(${t}, ${r}, ${s}, ${o.toFixed(2)})`;return{hex:a,rgba:f}}parseFontWeight(e){let n={thin:100,extralight:200,light:300,regular:400,medium:500,semibold:600,bold:700,extrabold:800,black:900},t=e.toLowerCase();for(let[s,o]of Object.entries(n))if(t.includes(s))return o;let r=e.match(/(\d+)/);return r?parseInt(r[1],10):400}getComponentUsageStats(e){let n=[],t=new Set;for(let r of figma.root.children)if(r.type==="PAGE"){let s=r.findAll(o=>{var a;return o.type==="INSTANCE"&&((a=o.mainComponent)==null?void 0:a.id)===e});s.length>0&&(n.push(...s),t.add(r.name))}return{instances:n.length,pages:Array.from(t)}}}});var z,q=N(()=>{"use strict";z=class{matchTokenToComponents(e,n){let t=[];for(let r of n.components){let s=this.matchComponentRecursively(e,r);if(s.length>0){let o=s.reduce((a,f)=>a+f.confidence,0)/s.length;t.push({component:r,matches:s,confidence:o})}}return t.sort((r,s)=>s.confidence-r.confidence),{token:e,matchingComponents:t,totalMatches:t.length,totalComponentsScanned:n.totalComponents}}matchComponentRecursively(e,n){let t=[];switch(e.type){case"color":t.push(...this.matchColor(e,n));break;case"fontFamily":case"fontWeight":case"typography":t.push(...this.matchTypography(e,n));break;case"dimension":t.push(...this.matchSpacing(e,n));break;case"shadow":t.push(...this.matchEffects(e,n));break;default:t.push(...this.matchByValue(e,n)),this.looksLikeSpacingToken(e)&&t.push(...this.matchSpacing(e,n)),this.looksLikeEffectToken(e)&&t.push(...this.matchEffects(e,n))}if(n.children&&n.children.length>0)for(let r of n.children){let s=this.matchComponentRecursively(e,r);for(let o of s)t.push(E(A({},o),{property:`${r.name} \u2192 ${o.property}`}))}return t}matchColor(e,n){let t=[],r=e.path.join("."),s=this.normalizeColor(e.value);for(let o of n.colors)if(o.tokenReference){let a=o.tokenReference.trim();a=a.replace(/^["']|["']$/g,""),a=a.replace(/^[{]|[}]$/g,""),a=a.replace(/^\$/,"");let f=a.toLowerCase(),u=r.toLowerCase();f===u?t.push({property:`${o.type} color (token ref)`,propertyType:"color",matchedValue:`${o.hex} \u2190 ${o.tokenReference}`,tokenValue:r,confidence:1}):(f.includes(u)||u.includes(f))&&t.push({property:`${o.type} color (token ref)`,propertyType:"color",matchedValue:`${o.hex} \u2190 ${o.tokenReference}`,tokenValue:r,confidence:.85})}if(t.length>0||!s)return t;for(let o of n.colors){let a=this.normalizeHex(o.hex),f=this.normalizeRgba(o.rgba),u=this.normalizeHex(s),y=this.normalizeRgba(s);if(u&&a&&u===a)t.push({property:`${o.type} color (value)`,propertyType:"color",matchedValue:o.hex,tokenValue:String(e.value),confidence:.7});else if(y&&f){let l=this.parseRgba(s),g=this.parseRgba(o.rgba);if(l&&g){let T=Math.abs(l.r-g.r),i=Math.abs(l.g-g.g),c=Math.abs(l.b-g.b),p=Math.abs(l.a-g.a);T<2&&i<2&&c<2&&p<.01&&t.push({property:`${o.type} color (value)`,propertyType:"color",matchedValue:o.rgba,tokenValue:String(e.value),confidence:.7})}}}return t}matchTypography(e,n){let t=[],r=e.path.join(".");for(let s of n.typography){let o=0,a="",f="value";if(s.tokenReference){let y=s.tokenReference.replace(/[{}]/g,"").replace(/^\$/,"").toLowerCase().replace(/\./g,"."),l=r.toLowerCase();y===l?(o=1,a=`${s.fontFamily} (ref: ${s.tokenReference})`,f="reference"):(y.includes(l)||l.includes(y))&&(o=.8,a=`${s.fontFamily} (ref: ${s.tokenReference})`,f="reference")}if(o===0){if(e.type==="fontFamily"){let u=String(e.value).toLowerCase().trim(),y=s.fontFamily.toLowerCase().trim();u===y&&(o=.9,a=s.fontFamily)}else if(e.type==="fontWeight"){let u=this.normalizeFontWeight(e.value),y=s.fontWeight;u===y&&(o=.9,a=String(y))}else if(e.type==="typography"&&typeof e.value=="object"&&e.value!==null){let u=e.value,y=!1,l=0,g=[];if(u.fontFamily){let T=String(u.fontFamily).toLowerCase().trim(),i=s.fontFamily.toLowerCase().trim();T===i&&(y=!0,l+=.4,g.push(`fontFamily: ${s.fontFamily}`))}if(u.fontSize){let T=Number(u.fontSize),i=s.fontSize;Math.abs(T-i)<.5&&(y=!0,l+=.3,g.push(`fontSize: ${i}`))}u.fontWeight&&this.normalizeFontWeight(u.fontWeight)===s.fontWeight&&(y=!0,l+=.3,g.push(`fontWeight: ${s.fontWeight}`)),y&&(o=Math.min(l,1),a=g.join(", "))}}o>0&&t.push({property:`typography${f==="reference"?" (token ref)":""}`,propertyType:"typography",matchedValue:a,tokenValue:String(e.value),confidence:o})}return t}matchSpacing(e,n){let t=[],r=e.path.join("."),s=this.normalizeDimension(e.value);for(let o of n.spacing)if(o.tokenReference){let a=o.tokenReference.trim();a=a.replace(/^["']|["']$/g,""),a=a.replace(/^[{]|[}]$/g,""),a=a.replace(/^\$/,"");let f=a.toLowerCase(),u=r.toLowerCase();f===u?t.push({property:`${o.type} (token ref)`,propertyType:"spacing",matchedValue:`${o.value}${o.unit} \u2190 ${o.tokenReference}`,tokenValue:r,confidence:1}):(f.includes(u)||u.includes(f))&&t.push({property:`${o.type} (token ref)`,propertyType:"spacing",matchedValue:`${o.value}${o.unit} \u2190 ${o.tokenReference}`,tokenValue:r,confidence:.85})}if(t.length>0||s===null)return t;for(let o of n.spacing){let a=o.value;Math.abs(s-a)<.5&&t.push({property:o.type,propertyType:"spacing",matchedValue:`${o.value}${o.unit}`,tokenValue:String(e.value),confidence:.7})}return t}matchEffects(e,n){let t=[],r=e.path.join(".");for(let o of n.effects)if(o.tokenReference){let a=o.tokenReference.trim();a=a.replace(/^["']|["']$/g,""),a=a.replace(/^[{]|[}]$/g,""),a=a.replace(/^\$/,"");let f=a.toLowerCase(),u=r.toLowerCase();f===u?t.push({property:`${o.type} (token ref)`,propertyType:"effect",matchedValue:`${o.type} \u2190 ${o.tokenReference}`,tokenValue:r,confidence:1}):(f.includes(u)||u.includes(f))&&t.push({property:`${o.type} (token ref)`,propertyType:"effect",matchedValue:`${o.type} \u2190 ${o.tokenReference}`,tokenValue:r,confidence:.85})}if(t.length>0||typeof e.value!="object"||e.value===null)return t;let s=e.value;for(let o of n.effects)if(o.type==="drop-shadow"||o.type==="inner-shadow"){let a=0,f=[],u=s.blur||s.radius||s.spreadRadius;if(u!==void 0&&o.radius!==void 0&&Math.abs(Number(u)-o.radius)<1&&(a+=.4,f.push(`radius: ${o.radius}px`)),s.color&&o.color){let y=this.normalizeColor(s.color),l=this.rgbaToString(o.color);y&&this.colorsMatch(y,l)&&(a+=.4,f.push(`color: ${l}`))}if(s.offset&&o.offset){let y=Number(s.offset.x||0),l=Number(s.offset.y||0),g=o.offset.x||0,T=o.offset.y||0;Math.abs(y-g)<1&&Math.abs(l-T)<1&&(a+=.2,f.push(`offset: ${g}, ${T}`))}a>0&&t.push({property:o.type,propertyType:"effect",matchedValue:f.join(", "),tokenValue:JSON.stringify(e.value),confidence:Math.min(a,.7)})}return t}matchByValue(e,n){let t=[];return this.looksLikeColor(e.value)&&t.push(...this.matchColor(e,n)),this.looksLikeDimension(e.value)&&t.push(...this.matchSpacing(e,n)),t}normalizeColor(e){if(typeof e!="string")return null;let n=e.trim().toLowerCase();return n.match(/^#[0-9a-f]{3,8}$/)||n.match(/^rgba?\(/)||n.match(/^hsla?\(/)?n:null}normalizeHex(e){if(!e)return null;let n=e.trim().toLowerCase().replace("#","");return n.length===3&&(n=n.split("").map(t=>t+t).join("")),n.length===6?n:null}normalizeRgba(e){if(!e)return null;let n=e.match(/rgba?\(([^)]+)\)/i);return n?n[1].trim():null}parseRgba(e){let n=this.normalizeRgba(e);if(!n)return null;let t=n.split(",").map(r=>parseFloat(r.trim()));return t.length>=3?{r:t[0],g:t[1],b:t[2],a:t.length>3?t[3]:1}:null}rgbaToString(e){return`rgba(${Math.round(e.r)}, ${Math.round(e.g)}, ${Math.round(e.b)}, ${e.a.toFixed(2)})`}colorsMatch(e,n){let t=this.parseRgba(e),r=this.parseRgba(n);if(t&&r)return Math.abs(t.r-r.r)<2&&Math.abs(t.g-r.g)<2&&Math.abs(t.b-r.b)<2&&Math.abs(t.a-r.a)<.01;let s=this.normalizeHex(e),o=this.normalizeHex(n);return s!==null&&o!==null&&s===o}normalizeFontWeight(e){if(typeof e=="number")return e;if(typeof e!="string")return 400;let n={thin:100,extralight:200,light:300,regular:400,normal:400,medium:500,semibold:600,bold:700,extrabold:800,black:900},t=e.toLowerCase().trim();if(n[t])return n[t];let r=parseInt(e,10);return isNaN(r)?400:r}normalizeDimension(e){if(typeof e=="number")return e;if(typeof e!="string")return null;let n=e.replace(/px|rem|em|pt|pc|in|cm|mm|q|vh|vw|vmin|vmax|%/g,"").trim(),t=parseFloat(n);return isNaN(t)?null:t}looksLikeColor(e){if(typeof e!="string")return!1;let n=e.trim().toLowerCase();return n.match(/^#[0-9a-f]{3,8}$/)!==null||n.match(/^rgba?\(/)!==null||n.match(/^hsla?\(/)!==null}looksLikeDimension(e){return typeof e=="number"?!0:typeof e!="string"?!1:/^-?\d+(\.\d+)?(px|rem|em|pt|pc|in|cm|mm|q|vh|vw|vmin|vmax|%)$/.test(e.trim())}looksLikeSpacingToken(e){let n=e.path.join(".").toLowerCase();return["spacing","space","size","sizing","dimension","width","height","padding","margin","gap","radius","border","inset","offset"].some(r=>n.includes(r))}looksLikeEffectToken(e){let n=e.path.join(".").toLowerCase();return["shadow","effect","blur","elevation","drop"].some(r=>n.includes(r))}}});function S(d,e){let n=`${X}`;return X+=1,M[n]={handler:e,name:d},function(){delete M[n]}}function Y(d,e){let n=!1;for(let t in M)M[t].name===d&&(M[t].handler.apply(null,e),n=!0);if(n===!1)throw new Error(`No event handler with name \`${d}\``)}var M,X,k,Z=N(()=>{M={},X=0;k=typeof window=="undefined"?function(d,...e){figma.ui.postMessage([d,...e])}:function(d,...e){window.parent.postMessage({pluginMessage:[d,...e]},"*")};typeof window=="undefined"?figma.ui.onmessage=function(d){if(!Array.isArray(d))return;let[e,...n]=d;typeof e=="string"&&Y(e,n)}:window.onmessage=function(d){if(typeof d.data.pluginMessage=="undefined")return;let e=d.data.pluginMessage;if(!Array.isArray(e))return;let[n,...t]=d.data.pluginMessage;typeof n=="string"&&Y(n,t)}});function B(d,e){if(typeof __html__=="undefined")throw new Error("No UI defined");let n=`<div id="create-figma-plugin"></div><script>document.body.classList.add('theme-${figma.editorType}');const __FIGMA_COMMAND__='${typeof figma.command=="undefined"?"":figma.command}';const __SHOW_UI_DATA__=${JSON.stringify(typeof e=="undefined"?{}:e)};${__html__}</script>`;figma.showUI(n,E(A({},d),{themeColors:typeof d.themeColors=="undefined"?!0:d.themeColors}))}var Q=N(()=>{});var ee=N(()=>{Z();Q()});var te={};le(te,{default:()=>ue});function ue(){B({width:400,height:550},{resizable:!0}),figma.loadAllPagesAsync().catch(i=>{console.error("Error loading pages on startup:",i)});let d=new I,e=new V,n=new z;async function t(){try{return await figma.clientStorage.getAsync("repoConfig")||null}catch(i){return console.error("Error loading config:",i),null}}async function r(i){try{await figma.clientStorage.setAsync("repoConfig",i)}catch(c){console.error("Error saving config:",c)}}async function s(){try{await figma.clientStorage.deleteAsync("repoConfig")}catch(i){console.error("Error clearing config:",i)}}S("load-config",async()=>{let i=await t();k("config-loaded",i)}),S("clear-config",async()=>{await s(),k("config-loaded",null)}),S("test-connection",async i=>{let c=d.parseGitHubUrl(i.repoUrl);if(!c){k("connection-result",{success:!1,error:"Invalid GitHub URL format"});return}try{k("connection-progress",{message:"Connecting to GitHub..."});let p=await d.fetchBranches(c.owner,c.repo,i.token),h=0,v=[];if(p.length>0)try{let m=p[0];k("connection-progress",{message:"Scanning for token files..."});let b=await d.detectTokenFiles(c.owner,c.repo,m,i.token,i.filePath||"");h=b.length,v=b.slice(0,5)}catch(m){console.error("Token detection failed:",m)}k("connection-result",{success:!0,branches:p.slice(0,10),owner:c.owner,repo:c.repo,fileCount:h,tokenCount:h,sampleFiles:v.map(m=>m.length>50?m.substring(0,47)+"...":m)})}catch(p){k("connection-result",{success:!1,error:p instanceof Error?p.message:"Connection failed"})}}),S("save-config",async i=>{await r(i),k("config-saved",{success:!0})});let o=(i,c)=>{let p=c.join(".").toLowerCase();if(typeof i=="string"){if(i.match(/^#[0-9A-Fa-f]{3,8}$/)||i.match(/^rgba?\(/)||i.match(/^hsla?\(/)||p.includes("color")||p.includes("colour"))return"color";if(i.match(/^\d+(\.\d+)?(ms|s)$/)||p.includes("duration"))return"duration";if(i.match(/^-?\d+(\.\d+)?(px|rem|em|pt|pc|in|cm|mm|q|vh|vw|vmin|vmax|%)$/)||p.includes("size")||p.includes("spacing")||p.includes("radius")||p.includes("gap")||p.includes("padding")||p.includes("margin"))return"dimension";if(p.includes("font")||p.includes("typography")||p.includes("text"))return p.includes("weight")?"fontWeight":p.includes("family")?"fontFamily":"typography";if(p.includes("shadow"))return"shadow";if(p.includes("border"))return"border"}else{if(typeof i=="number")return p.includes("weight")?"fontWeight":(p.includes("opacity")||p.includes("alpha")||p.includes("z-index")||p.includes("zindex"),"number");if(typeof i=="object"&&i!==null){if(p.includes("shadow")||i.blur!==void 0||i.spread!==void 0)return"shadow";if(p.includes("typography")||i.fontFamily!==void 0)return"typography";if(p.includes("border")||i.width!==void 0&&i.style!==void 0)return"border"}}return"string"},a=i=>i&&typeof i=="object"&&"$value"in i,f=i=>{if(!i||typeof i!="object"||"$value"in i||!("value"in i))return!1;let c=i.value;return typeof c=="string"||typeof c=="number"||typeof c=="boolean"?!0:typeof c=="object"&&c!==null?"type"in i||"description"in i:!1},u=(i,c)=>!(typeof i!="string"&&typeof i!="number"&&typeof i!="boolean"||c.length<1),y=(i,c)=>{let p=[],h=(m,b,w)=>{let P=w[w.length-1]||"unnamed",R=b||o(m,w);p.push({name:P,path:[...w],type:R,sourceFile:c,value:m})},v=(m,b,w)=>{if(m==null)return;let P=b[b.length-1]||"";if(!(P.startsWith("$")&&P!=="$value"&&P!=="$type")){if(a(m)){h(m.$value,m.$type,b);return}if(f(m)){h(m.value,m.type,b);return}if(u(m,b)){h(m,void 0,b);return}if(typeof m=="object"){let R=Array.isArray(m)?m.map((C,$)=>String($)):Object.keys(m);for(let C of R){if(!Array.isArray(m)&&(C.startsWith("$")||C==="extensions"))continue;let $=Array.isArray(m)?m[parseInt(C)]:m[C];v($,[...b,C],w+1)}}}};return v(i,[],0),p};S("fetch-tokens",async i=>{let c=d.parseGitHubUrl(i.repoUrl);if(!c){k("tokens-result",{success:!1,error:"Invalid GitHub URL format"});return}try{let p=i.filePath||"";k("tokens-progress",{message:"Scanning for token files..."});let h=await d.detectTokenFiles(c.owner,c.repo,i.branch,i.token,p);if(h.length===0){k("tokens-result",{success:!1,error:`No token files found${p?` in '${p}'`:" in repository"}. Looking for .json files (excluding config files).`});return}let v=[],m=[],b=0,w=0,P=[],R=150;for(let C of h)try{k("tokens-progress",{message:`Processing ${C}...`});let $=await d.fetchFileContents(c.owner,c.repo,i.branch,i.token,C);if(!$.content)throw new Error("Empty file content");let re=d.decodeBase64Content($.content),_;try{_=JSON.parse(re)}catch(W){throw new Error(`JSON parse failed: ${W.message}`)}let U=y(_,C),F=U.length;w+=F,P.push({file:C,count:F}),k("tokens-progress",{message:`Found ${F} tokens in ${C}`}),F===0&&m.push({file:C,message:"No token values found in this file (checked $value, value, and primitives)"});for(let W of U)if(v.length<R)v.push(W);else break;b++}catch($){console.error(`Failed to parse ${C}:`,$),P.push({file:C,count:0}),m.push({file:C,message:$ instanceof Error?$.message:"Failed to parse file"})}k("tokens-result",{success:!0,tokens:v.map(C=>({name:C.name||"",path:C.path||"",type:C.type||"unknown",sourceFile:C.sourceFile||""})),metadata:{totalTokens:w,truncated:w>v.length,filesProcessed:b,totalFiles:h.length,perFileCounts:P,errors:m}})}catch(p){k("tokens-result",{success:!1,error:p instanceof Error?p.message:"Failed to fetch tokens"})}}),S("detect-token-files",async i=>{let c=d.parseGitHubUrl(i.repoUrl);if(!c){k("token-files-result",{success:!1,error:"Invalid GitHub URL format"});return}try{let p=await d.detectTokenFiles(c.owner,c.repo,i.branch,i.token,i.directoryPath||"");k("token-files-result",{success:!0,files:p})}catch(p){k("token-files-result",{success:!1,error:p instanceof Error?p.message:"Failed to detect token files"})}}),S("scan-components",async i=>{try{let c=i.scanAll===!0;c?(k("scan-progress",{message:"Loading all pages..."}),await figma.loadAllPagesAsync(),k("scan-progress",{message:"Scanning all pages..."})):k("scan-progress",{message:"Scanning current page..."});let p=c?e.scanAllComponents():e.scanCurrentPage();k("scan-result",{success:!0,result:p})}catch(c){k("scan-result",{success:!1,error:c instanceof Error?c.message:"Failed to scan components"})}}),S("scan-components-for-token",async i=>{try{let{token:c,scanAll:p,scanSelection:h}=i,v=p===!0,m=h===!0;if(!c){k("scan-result",{success:!1,error:"No token provided"});return}let b="Scanning for token matches...";v?(b="Loading all pages...",k("scan-progress",{message:b}),await figma.loadAllPagesAsync(),b="Scanning all pages for token matches..."):m?b="Scanning selection for token matches...":b="Scanning current page for token matches...",k("scan-progress",{message:b}),k("scan-progress",{message:"Scanning components..."});let w;if(v)w=e.scanAllComponents();else if(m){let C=figma.currentPage.selection;if(C.length===0){k("scan-result",{success:!1,error:"No selection found. Please select a frame or node to scan."});return}w=e.scanNodes(C)}else w=e.scanCurrentPage();k("scan-progress",{message:`Found ${w.totalComponents} components. Matching tokens...`});let P=n.matchTokenToComponents(c,w);k("scan-progress",{message:"Matching complete!"});let R={token:{name:c.name,path:c.path,type:c.type,value:c.value},matchingComponents:P.matchingComponents.map(C=>({id:C.component.id,name:C.component.name,page:C.component.pageName,type:C.component.type,matches:C.matches.map($=>`${$.property}: ${$.matchedValue}`),matchDetails:C.matches,confidence:C.confidence})),totalMatches:P.totalMatches,totalComponentsScanned:P.totalComponentsScanned};k("scan-result",{success:!0,result:R})}catch(c){k("scan-result",{success:!1,error:c instanceof Error?c.message:"Failed to scan components for token"})}}),S("get-component-usage",async i=>{try{let{componentId:c}=i,p=e.getComponentUsageStats(c);k("component-usage-result",{success:!0,stats:p})}catch(c){k("component-usage-result",{success:!1,error:c instanceof Error?c.message:"Failed to get usage stats"})}}),S("navigate-to-component",async i=>{try{let{componentId:c}=i,p=figma.getNodeById(c);if(p&&"type"in p){let h=l(p);h&&h.type==="PAGE"&&h!==figma.currentPage&&await figma.setCurrentPageAsync(h),p.type!=="DOCUMENT"&&p.type!=="PAGE"?(figma.currentPage.selection=[p],figma.viewport.scrollAndZoomIntoView([p]),k("navigate-result",{success:!0})):k("navigate-result",{success:!1,error:"Cannot select document or page nodes"})}else k("navigate-result",{success:!1,error:"Node not found"})}catch(c){k("navigate-result",{success:!1,error:c instanceof Error?c.message:"Failed to navigate to component"})}});function l(i){let c=i;for(;c&&c.type!=="PAGE";)c=c.parent;return c}S("cancel",()=>{figma.closePlugin()}),S("resize-window",i=>{figma.ui.resize(i.width,i.height)});function g(i){let c={nodeId:i.id,nodeName:i.name,nodeType:i.type,pluginData:{},sharedPluginData:{}};try{let h=i.getPluginDataKeys();for(let v of h)c.pluginData[v]=i.getPluginData(v)}catch(h){console.error("Error getting plugin data keys:",h)}let p=["tokens","tokens-studio","tokensStudio","figma-tokens","design-tokens","token-studio","com.tokens.studio","tokens.studio","io.tokens.studio","figmatokens","style-dictionary","ds","design-system","theme","variables"];for(let h of p)try{let v=i.getSharedPluginDataKeys(h);if(v.length>0){c.sharedPluginData[h]={};for(let m of v){let b=i.getSharedPluginData(h,m);c.sharedPluginData[h][m]=b}}}catch(v){}try{if("boundVariables"in i&&i.boundVariables){c.boundVariables={};let h=i.boundVariables;for(let[v,m]of Object.entries(h))if(m){if(Array.isArray(m))c.boundVariables[v]=m.map(b=>{try{let w=figma.variables.getVariableById(b.id);return{id:b.id,name:w==null?void 0:w.name,resolvedType:w==null?void 0:w.resolvedType,valuesByMode:w==null?void 0:w.valuesByMode}}catch(w){return{id:b.id,error:"Could not resolve variable"}}});else if(m.id)try{let b=figma.variables.getVariableById(m.id);c.boundVariables[v]={id:m.id,name:b==null?void 0:b.name,resolvedType:b==null?void 0:b.resolvedType,valuesByMode:b==null?void 0:b.valuesByMode}}catch(b){c.boundVariables[v]={id:m.id,error:"Could not resolve variable"}}}}}catch(h){console.error("Error getting bound variables:",h)}return c}function T(i,c=3,p=0){let h=[],v=g(i),m=Object.keys(v.pluginData).length>0||Object.keys(v.sharedPluginData).length>0||v.boundVariables&&Object.keys(v.boundVariables).length>0;if(h.push(E(A({},v),{pluginData:m?v.pluginData:{_noData:"true"}})),p<c&&"children"in i)for(let b of i.children)h.push(...T(b,c,p+1));return h}S("inspect-selection",async()=>{try{let i=figma.currentPage.selection;if(i.length===0){k("inspect-result",{success:!1,error:"No selection. Please select a node to inspect."});return}k("inspect-progress",{message:"Inspecting plugin data..."});let c=[];for(let h of i){let v=T(h,3);c.push(...v)}let p=c.filter(h=>!h.pluginData._noData&&(Object.keys(h.pluginData).length>0||Object.keys(h.sharedPluginData).length>0||h.boundVariables&&Object.keys(h.boundVariables).length>0));c.forEach(h=>{h.pluginData._noData&&(h.pluginData={})}),k("inspect-result",{success:!0,results:c,summary:{totalNodesInspected:c.length,nodesWithPluginData:p.length,namespacesFound:Array.from(new Set(p.flatMap(h=>Object.keys(h.sharedPluginData)))),pluginDataKeysFound:Array.from(new Set(p.flatMap(h=>Object.keys(h.pluginData)))),hasVariableBindings:p.some(h=>h.boundVariables&&Object.keys(h.boundVariables).length>0)}})}catch(i){k("inspect-result",{success:!1,error:i instanceof Error?i.message:"Failed to inspect selection"})}})}var ne=N(()=>{"use strict";j();J();q();ee()});var ge={"src/main.ts--default":(ne(),pe(te)).default},de="src/main.ts--default";ge[de]();
